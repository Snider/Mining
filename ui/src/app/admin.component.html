<!-- Setup Wizard View -->
@if (needsSetup) {
  <div class="setup-wizard">
    <p>To begin, please install a miner from the list below.</p>
    <h4>Available Miners</h4>
    <div class="miner-list">
      @for (miner of manageableMiners; track miner.name) {
        <div class="miner-item">
          <span>{{ miner.name }}</span>
          <wa-button
            variant="success"
            size="small"
            [disabled]="actionInProgress === 'install-' + miner.name"
            (click)="installMiner(miner.name)">
            @if (actionInProgress === 'install-' + miner.name) {
              <wa-spinner class="button-spinner"></wa-spinner>
            } @else {
              <wa-icon name="download" slot="prefix"></wa-icon>
              Install
            }
          </wa-button>
        </div>
      } @empty {
        <div class="miner-item">
          <span>Could not load available miners.</span>
        </div>
      }
    </div>
  </div>
}

<!-- Standard Admin Panel View -->
@if (!needsSetup) {
  <div class="admin-panel">
    @if (error) {
      <wa-card class="card-error">
        <div slot="header">
          <wa-icon name="exclamation-triangle" style="font-size: 1.5rem;"></wa-icon>
          An Error Occurred
        </div>
        <p>{{ error }}</p>
      </wa-card>
    }

    <h4>Manage Miners</h4>
    <div class="miner-list">
      @for (miner of manageableMiners; track miner.name) {
        <div class="miner-item">
          <span>{{ miner.name }}</span>
          @if (miner.is_installed) {
            <wa-button
              variant="danger"
              size="small"
              [disabled]="actionInProgress === 'uninstall-' + miner.name"
              (click)="uninstallMiner(miner.name)">
              @if (actionInProgress === 'uninstall-' + miner.name) {
                <wa-spinner class="button-spinner"></wa-spinner>
              } @else {
                <wa-icon name="trash" slot="prefix"></wa-icon>
                Uninstall
              }
            </wa-button>
          } @else {
            <wa-button
              variant="success"
              size="small"
              [disabled]="actionInProgress === 'install-' + miner.name"
              (click)="installMiner(miner.name)">
              @if (actionInProgress === 'install-' + miner.name) {
                <wa-spinner class="button-spinner"></wa-spinner>
              } @else {
                <wa-icon name="download" slot="prefix"></wa-icon>
                Install
              }
            </wa-button>
          }
        </div>
      } @empty {
        <div class="miner-item">
          <span>Could not load available miners.</span>
        </div>
      }
    </div>

    <h4 class="section-title">Antivirus Whitelist Paths</h4>
    <div class="path-list">
      <p>To prevent antivirus software from interfering, please add the following paths to your exclusion list:</p>
      <ul>
        @for (path of whitelistPaths; track path) {
          <li><code>{{ path }}</code></li>
        } @empty {
            <li>No paths to display. Install a miner to see required paths.</li>
        }
      </ul>
    </div>
  </div>
}
